<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>LipidAdduct.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">jgoslin-parsers</a> &gt; <a href="index.source.html" class="el_package">org.lifstools.jgoslin.domain</a> &gt; <span class="el_source">LipidAdduct.java</span></div><h1>LipidAdduct.java</h1><pre class="source lang-java linenums">/*
 * Copyright 2021 Dominik Kopczynski, Nils Hoffmann.
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package org.lifstools.jgoslin.domain;

import com.fasterxml.jackson.annotation.JsonIgnore;
import java.util.Map.Entry;

/**
 * Base class for lipid names parsed using the different grammars. This can
 * contain a lipid, an adduct and a sum formula.
 *
 * @author Dominik Kopczynski
 * @author Nils Hoffmann
 */
public final class LipidAdduct {

    private final LipidSpecies lipid;
    private final Adduct adduct;

<span class="fc" id="L33">    public LipidAdduct(LipidSpecies lipid, Adduct adduct) {</span>
<span class="fc" id="L34">        this.lipid = lipid;</span>
<span class="fc" id="L35">        this.adduct = adduct;</span>
<span class="fc" id="L36">    }</span>

    public String getLipidString() {
<span class="fc" id="L39">        return getLipidString(LipidLevel.NO_LEVEL);</span>
    }

    public String getLipidString(LipidLevel level) {
<span class="fc" id="L43">        StringBuilder sb = new StringBuilder();</span>
<span class="pc bpc" id="L44" title="1 of 2 branches missed.">        if (lipid != null) {</span>
<span class="fc" id="L45">            sb.append(lipid.getLipidString(level));</span>
        } else {
<span class="nc" id="L47">            return &quot;&quot;;</span>
        }

<span class="fc bfc" id="L50" title="All 2 branches covered.">        switch (level) {</span>
            case CLASS:
            case CATEGORY:
<span class="fc" id="L53">                break;</span>

            default:
<span class="fc bfc" id="L56" title="All 2 branches covered.">                if (adduct != null) {</span>
<span class="fc" id="L57">                    sb.append(adduct.getLipidString());</span>
                }
                break;
        }

<span class="fc" id="L62">        return sb.toString();</span>
    }

    public String getClassName() {
<span class="nc bnc" id="L66" title="All 2 branches missed.">        return (lipid != null) ? lipid.headGroup.getClassName() : &quot;&quot;;</span>
    }

    @JsonIgnore
    public boolean isLyso() {
<span class="pc bpc" id="L71" title="1 of 2 branches missed.">        return (LipidClasses.getInstance().size() &gt; lipid.headGroup.getLipidClass()) ? LipidClasses.getInstance().get(lipid.headGroup.getLipidClass()).specialCases.contains(&quot;Lyso&quot;) : false;</span>
    }

    @JsonIgnore
    public boolean isCardioLipin() {
<span class="pc bpc" id="L76" title="1 of 2 branches missed.">        return (LipidClasses.getInstance().size() &gt; lipid.headGroup.getLipidClass()) ? LipidClasses.getInstance().get(lipid.headGroup.getLipidClass()).specialCases.contains(&quot;Cardio&quot;) : false;</span>
    }

    @JsonIgnore
    public boolean isContainsSugar() {
<span class="pc bpc" id="L81" title="1 of 2 branches missed.">        return (LipidClasses.getInstance().size() &gt; lipid.headGroup.getLipidClass()) ? LipidClasses.getInstance().get(lipid.headGroup.getLipidClass()).specialCases.contains(&quot;Sugar&quot;) : false;</span>
    }

    @JsonIgnore
    public boolean isContainsEster() {
<span class="pc bpc" id="L86" title="1 of 2 branches missed.">        return (LipidClasses.getInstance().size() &gt; lipid.headGroup.getLipidClass()) ? LipidClasses.getInstance().get(lipid.headGroup.getLipidClass()).specialCases.contains(&quot;Ester&quot;) : false;</span>
    }

    @JsonIgnore
    public boolean isSpException() {
<span class="pc bpc" id="L91" title="1 of 2 branches missed.">        return (LipidClasses.getInstance().size() &gt; lipid.headGroup.getLipidClass()) ? LipidClasses.getInstance().get(lipid.headGroup.getLipidClass()).specialCases.contains(&quot;SP_Exception&quot;) : false;</span>
    }

    public LipidLevel getLipidLevel() {
<span class="fc" id="L95">        return lipid.getLipidLevel();</span>
    }

    public String getExtendedClass() {
<span class="pc bpc" id="L99" title="1 of 2 branches missed.">        return (lipid != null) ? lipid.getExtendedClass() : &quot;&quot;;</span>
    }

    public double getMass() {
<span class="fc" id="L103">        ElementTable elements = getElements();</span>
<span class="fc" id="L104">        int charge = 0;</span>
<span class="fc" id="L105">        double mass = 0;</span>

<span class="fc bfc" id="L107" title="All 2 branches covered.">        if (adduct != null) {</span>
<span class="fc" id="L108">            charge = adduct.getCharge();</span>
        }

<span class="fc bfc" id="L111" title="All 2 branches covered.">        for (Entry&lt;Element, Integer&gt; kvp : elements.entrySet()) {</span>
<span class="fc" id="L112">            mass += Elements.ELEMENT_MASSES.get(kvp.getKey()) * kvp.getValue();</span>
<span class="fc" id="L113">        }</span>

<span class="fc bfc" id="L115" title="All 2 branches covered.">        if (charge != 0) {</span>
<span class="fc" id="L116">            mass = (mass - charge * Elements.ELECTRON_REST_MASS) / Math.abs(charge);</span>
        }

<span class="fc" id="L119">        return mass;</span>
    }

    @JsonIgnore
    public ElementTable getElements() {
<span class="fc" id="L124">        ElementTable elements = new ElementTable();</span>

<span class="pc bpc" id="L126" title="1 of 2 branches missed.">        if (lipid != null) {</span>
<span class="fc" id="L127">            ElementTable lipid_elements = lipid.getElements();</span>
<span class="fc bfc" id="L128" title="All 2 branches covered.">            for (Entry&lt;Element, Integer&gt; kv : lipid_elements.entrySet()) {</span>
<span class="fc" id="L129">                elements.put(kv.getKey(), elements.get(kv.getKey()) + kv.getValue());</span>
<span class="fc" id="L130">            }</span>
        }

<span class="fc bfc" id="L133" title="All 2 branches covered.">        if (adduct != null) {</span>
<span class="fc" id="L134">            ElementTable adduct_elements = adduct.getElements();</span>
<span class="fc bfc" id="L135" title="All 2 branches covered.">            for (Entry&lt;Element, Integer&gt; kv : adduct_elements.entrySet()) {</span>
<span class="fc" id="L136">                elements.put(kv.getKey(), elements.get(kv.getKey()) + kv.getValue());</span>
<span class="fc" id="L137">            }</span>
        }
<span class="fc" id="L139">        return elements;</span>
    }

    @Override
    public String toString() {
<span class="fc" id="L144">        return LipidAdduct.this.getLipidString();</span>
    }

    public String getSumFormula() {
<span class="fc" id="L148">        return getElements().getSumFormula();</span>
    }

    public LipidSpecies getLipid() {
<span class="fc" id="L152">        return lipid;</span>
    }

    public Adduct getAdduct() {
<span class="fc" id="L156">        return adduct;</span>
    }

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.8.202204050719</span></div></body></html>