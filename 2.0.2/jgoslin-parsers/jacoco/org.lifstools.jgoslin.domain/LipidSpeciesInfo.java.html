<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>LipidSpeciesInfo.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">jgoslin-parsers</a> &gt; <a href="index.source.html" class="el_package">org.lifstools.jgoslin.domain</a> &gt; <span class="el_source">LipidSpeciesInfo.java</span></div><h1>LipidSpeciesInfo.java</h1><pre class="source lang-java linenums">/*
 * Copyright 2021 Dominik Kopczynski, Nils Hoffmann.
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package org.lifstools.jgoslin.domain;

import com.fasterxml.jackson.annotation.JsonIgnore;
import java.util.ArrayList;
import java.util.Map.Entry;

/**
 * This class summarizes the FA parts of a lipid, independent of its head group.
 * Thus, it accounts the total number of carbon atoms, double bonds, the number
 * of hydroxylations, the overall FA-headgroup bond type, e.g. ETHER PLASMANYL /
 * PLASMENYL, if any of a lipid's FA chains has such a bond type, or ESTER, AMINE, LCB or
 * UNDEFINED for other cases.
 * 
 * @author Dominik Kopczynski
 * @author Nils Hoffmann
 */
public final class LipidSpeciesInfo extends FattyAcid {

    private LipidLevel level;
    public int numEthers;
    public int numSpecifiedFa;
    public int totalFa;
    public LipidFaBondType extendedClass;
<span class="fc" id="L39">    public static final String[] ETHER_PREFIX = {&quot;&quot;, &quot;O-&quot;, &quot;dO-&quot;, &quot;tO-&quot;, &quot;eO-&quot;};</span>
    public int lipidClass;

    public LipidSpeciesInfo(int _lipid_class, KnownFunctionalGroups knownFunctionalGroups) {
<span class="fc" id="L43">        super(&quot;info&quot;, knownFunctionalGroups);</span>
<span class="fc" id="L44">        lipidClass = _lipid_class;</span>
<span class="fc" id="L45">        level = LipidLevel.NO_LEVEL;</span>
<span class="fc" id="L46">        numEthers = 0;</span>
<span class="fc" id="L47">        numSpecifiedFa = 0;</span>
<span class="fc" id="L48">        extendedClass = LipidFaBondType.ESTER;</span>
<span class="pc bpc" id="L49" title="1 of 2 branches missed.">        totalFa = (LipidClasses.getInstance().size() &gt; lipidClass) ? LipidClasses.getInstance().get(lipidClass).maxNumFa : 0;</span>
<span class="fc" id="L50">    }</span>

    @Override
    public LipidSpeciesInfo copy() {
<span class="fc" id="L54">        LipidSpeciesInfo lsi = new LipidSpeciesInfo(lipidClass, knownFunctionalGroups);</span>
<span class="fc" id="L55">        lsi.level = level;</span>
<span class="fc" id="L56">        lsi.numEthers = numEthers;</span>
<span class="fc" id="L57">        lsi.numSpecifiedFa = numSpecifiedFa;</span>
<span class="fc" id="L58">        lsi.setPosition(getPosition());</span>
<span class="fc" id="L59">        lsi.totalFa = totalFa;</span>
<span class="fc" id="L60">        lsi.extendedClass = extendedClass;</span>
<span class="fc" id="L61">        lsi.numCarbon = numCarbon;</span>
<span class="fc" id="L62">        lsi.doubleBonds = doubleBonds.copy();</span>
<span class="fc" id="L63">        lsi.lipidFaBondType = lipidFaBondType;</span>

<span class="fc" id="L65">        functionalGroups.entrySet().stream().map(kv -&gt; {</span>
<span class="fc" id="L66">            lsi.functionalGroups.put(kv.getKey(), new ArrayList&lt;&gt;());</span>
<span class="fc" id="L67">            return kv;</span>
<span class="fc" id="L68">        }).forEachOrdered(kv -&gt; {</span>
<span class="fc" id="L69">            kv.getValue().forEach(func_group -&gt; {</span>
<span class="fc" id="L70">                lsi.functionalGroups.get(kv.getKey()).add(func_group.copy());</span>
<span class="fc" id="L71">            });</span>
<span class="fc" id="L72">        });</span>
<span class="fc" id="L73">        return lsi;</span>
    }

    @JsonIgnore
    @Override
    public ElementTable getElements() {
<span class="fc" id="L79">        ElementTable elements = super.computeAndCopyElements();</span>
<span class="fc bfc" id="L80" title="All 2 branches covered.">        if (lipidFaBondType != LipidFaBondType.LCB_EXCEPTION) {</span>
<span class="fc bfc" id="L81" title="All 2 branches covered.">            elements.put(Element.O, elements.get(Element.O) - ((numEthers == 0) ? 1 : 0));</span>
        }
<span class="fc bfc" id="L83" title="All 2 branches covered.">        elements.put(Element.H, elements.get(Element.H) + (numEthers == 0 ? 1 : -1));</span>

<span class="fc" id="L85">        return elements;</span>
    }

    public void add(FattyAcid _fa) {
<span class="fc bfc" id="L89" title="All 4 branches covered.">        if (_fa.lipidFaBondType == LipidFaBondType.ETHER_PLASMENYL || _fa.lipidFaBondType == LipidFaBondType.ETHER_PLASMANYL) {</span>
<span class="fc" id="L90">            numEthers += 1;</span>
<span class="fc" id="L91">            lipidFaBondType = LipidFaBondType.ETHER_PLASMANYL;</span>
<span class="fc" id="L92">            extendedClass = _fa.lipidFaBondType;</span>
<span class="fc bfc" id="L93" title="All 4 branches covered.">        } else if (_fa.lipidFaBondType == LipidFaBondType.LCB_EXCEPTION || _fa.lipidFaBondType == LipidFaBondType.LCB_REGULAR) {</span>
<span class="fc" id="L94">            lipidFaBondType = _fa.lipidFaBondType;</span>
        } else {
<span class="fc" id="L96">            numSpecifiedFa += 1;</span>
        }
<span class="fc bfc" id="L98" title="All 2 branches covered.">        for (Entry&lt;String, ArrayList&lt;FunctionalGroup&gt;&gt; kv : _fa.functionalGroups.entrySet()) {</span>
<span class="fc bfc" id="L99" title="All 2 branches covered.">            if (!functionalGroups.containsKey(kv.getKey())) {</span>
<span class="fc" id="L100">                functionalGroups.put(kv.getKey(), new ArrayList&lt;FunctionalGroup&gt;());</span>
            }
<span class="fc bfc" id="L102" title="All 2 branches covered.">            for (FunctionalGroup func_group : kv.getValue()) {</span>
<span class="fc" id="L103">                functionalGroups.get(kv.getKey()).add(func_group.copy());</span>
<span class="fc" id="L104">            }</span>
<span class="fc" id="L105">        }</span>

<span class="fc" id="L107">        ElementTable e = _fa.computeAndCopyElements();</span>
<span class="fc" id="L108">        numCarbon += e.get(Element.C);</span>
<span class="fc" id="L109">        doubleBonds.setNumDoubleBonds(doubleBonds.getNumDoubleBonds() + _fa.getNDoubleBonds());</span>

<span class="fc" id="L111">    }</span>

    @Override
    public String toString() {
<span class="fc" id="L115">        StringBuilder info_string = new StringBuilder();</span>
<span class="fc" id="L116">        info_string.append(ETHER_PREFIX[numEthers]);</span>
<span class="fc" id="L117">        info_string.append(numCarbon).append(&quot;:&quot;).append(doubleBonds.getNumDoubleBonds());</span>

<span class="fc" id="L119">        ElementTable fg_elements = getFunctionalGroupElements();</span>
<span class="fc bfc" id="L120" title="All 2 branches covered.">        for (int i = 2; i &lt; Elements.ELEMENT_ORDER.size(); ++i) {</span>
<span class="fc" id="L121">            Element e = Elements.ELEMENT_ORDER.get(i);</span>
<span class="fc bfc" id="L122" title="All 2 branches covered.">            if (fg_elements.get(e) &gt; 0) {</span>
<span class="fc" id="L123">                info_string.append(&quot;;&quot;).append(Elements.ELEMENT_SHORTCUT.get(e));</span>
<span class="fc bfc" id="L124" title="All 2 branches covered.">                if (fg_elements.get(e) &gt; 1) {</span>
<span class="fc" id="L125">                    info_string.append(fg_elements.get(e));</span>
                }
            }
        }

<span class="fc" id="L130">        return info_string.toString();</span>
    }

    public LipidLevel getLevel() {
<span class="fc" id="L134">        return level;</span>
    }

    public void setLevel(LipidLevel level) {
<span class="fc" id="L138">        this.level = level;</span>
<span class="fc" id="L139">    }</span>

    public int getNumEthers() {
<span class="nc" id="L142">        return numEthers;</span>
    }

    public void setNumEthers(int numEthers) {
<span class="nc" id="L146">        this.numEthers = numEthers;</span>
<span class="nc" id="L147">    }</span>

    public int getNumSpecifiedFa() {
<span class="nc" id="L150">        return numSpecifiedFa;</span>
    }

    public void setNumSpecifiedFa(int numSpecifiedFa) {
<span class="nc" id="L154">        this.numSpecifiedFa = numSpecifiedFa;</span>
<span class="nc" id="L155">    }</span>

    public int getTotalFa() {
<span class="nc" id="L158">        return totalFa;</span>
    }

    public void setTotalFa(int totalFa) {
<span class="nc" id="L162">        this.totalFa = totalFa;</span>
<span class="nc" id="L163">    }</span>

    public LipidFaBondType getExtendedClass() {
<span class="nc" id="L166">        return extendedClass;</span>
    }

    public void setExtendedClass(LipidFaBondType extendedClass) {
<span class="nc" id="L170">        this.extendedClass = extendedClass;</span>
<span class="nc" id="L171">    }</span>

    public int getLipidClass() {
<span class="nc" id="L174">        return lipidClass;</span>
    }

    public void setLipidClass(int lipidClass) {
<span class="nc" id="L178">        this.lipidClass = lipidClass;</span>
<span class="nc" id="L179">    }</span>
    
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.8.202204050719</span></div></body></html>